(function(e){function t(t){for(var r,s,o=t[0],c=t[1],u=t[2],h=0,l=[];h<o.length;h++)s=o[h],a[s]&&l.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(l.length)l.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/20190804_three_js_and_vue_ts/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"3cf3":function(e,t,n){"use strict";var r=n("41ec"),a=n.n(r);a.a},"41ec":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var r=n("5e27"),a=n.n(r);a.a},"5e27":function(e,t,n){},"7e2b":function(e,t,n){},8039:function(e,t,n){"use strict";var r=n("7e2b"),a=n.n(r);a.a},8412:function(e,t,n){"use strict";var r=n("cae5"),a=n.n(r);a.a},b66c:function(e,t,n){},cae5:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("ThreeWrapper",{ref:"threeWrapper",attrs:{speed:e.speed}}),n("UI",{ref:"ui1",on:{onSpeedChanged:function(t){return e.onSpeedChanged(t)}}})],1)},i=[],s=n("d225"),o=n("b0b4"),c=n("308d"),u=n("6bb5"),d=n("4e2b"),h=n("9ab4"),l=n("60a3"),p=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},f=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper",attrs:{id:"wrapper"}},[n("canvas",{attrs:{id:"canvas"}})])}],v=(n("96cf"),n("3b8d")),m=n("5a89"),b=n("34ad"),y=function(){function e(){Object(s["a"])(this,e),this.BACKGROUND_KEY="./ibl/simple_equirecutangler.png",this.THIRD_CHAN_KEY="./gltfs/third-chan_ver20190811-onemesh.gltf",this.GREEN_BLOCK_KEY="./gltfs/green-block.glb",this.loadedTextures={},this.loadedModels={},this.textureLoader=new m["ib"],this.gltfLoader=new b["a"]}return Object(o["a"])(e,[{key:"LoadAsync",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.LoadTexture(this.BACKGROUND_KEY);case 2:return this.loadedTextures[this.BACKGROUND_KEY]=e.sent,e.next=5,this.LoadGlTF(this.THIRD_CHAN_KEY);case 5:return this.loadedModels[this.THIRD_CHAN_KEY]=e.sent,e.next=8,this.LoadGlTF(this.GREEN_BLOCK_KEY);case 8:this.loadedModels[this.GREEN_BLOCK_KEY]=e.sent;case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"LoadTexture",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){n.textureLoader.load(t,function(t){t.anisotropy=16,e(t)},function(e){},function(e){r(e)})}));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"LoadGlTF",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){n.gltfLoader.load(t,function(t){e(t)},function(e){},function(e){r(e)})}));case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),O=(n("7f7f"),n("ac4d"),n("8a81"),n("ac6a"),function(){function e(t){Object(s["a"])(this,e),this.context=t}return Object(o["a"])(e,[{key:"GetAnimation",value:function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var o=i.value;if(o.name===t)return o}}catch(c){r=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}}}]),e}()),w=function(e){function t(){return Object(s["a"])(this,t),Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments))}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"AddToScene",value:function(){this.context.loader.loadedTextures[this.context.loader.BACKGROUND_KEY].mapping=m["lb"],this.context.scene.background=this.context.loader.loadedTextures[this.context.loader.BACKGROUND_KEY]}}]),t}(O),j=function(e){function t(){return Object(s["a"])(this,t),Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments))}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"AddToScene",value:function(){var e=new m["a"](16777215,.8);this.context.scene.add(e);var t=new m["k"](16777215,1);t.position.set(1,2,1),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.near=.01,t.shadow.camera.far=100,this.context.scene.add(t)}}]),t}(O),g=function e(){Object(s["a"])(this,e)};g.Sleep=function(e){return new Promise(function(t){return setTimeout(t,e)})};var _=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.isJump=!1,e.base=new m["o"],e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"Create",value:function(){var e=this.context.loader.loadedModels[this.context.loader.THIRD_CHAN_KEY],t=e.scene;e.scene.traverse(function(e){e instanceof m["H"]&&(e.castShadow=!0)});var n=e.scene.children[0];if(this.mesh=n,this.mixer=new m["c"](e.scene),this.idleClip=this.GetAnimation(e.animations,"Idle"),this.idleClip){var r=this.mixer.clipAction(this.idleClip);r.play()}else console.error('clip "Idle" not found...');return this.jumpClip=this.GetAnimation(e.animations,"Jump"),this.jumpClip||console.error('clip "Jump" not found...'),this.base.add(t),this.base}},{key:"Animate",value:function(e){this.mixer&&this.mixer.update(e)}},{key:"Jump",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isJump){e.next=2;break}return e.abrupt("return");case 2:return this.mixer.stopAllAction(),t=this.mixer.clipAction(this.jumpClip),t.setLoop(m["D"],1),t.play(),this.isJump=!0,e.next=9,g.Sleep(1e3*this.jumpClip.duration);case 9:this.isJump=!1,n=this.mixer.clipAction(this.idleClip),n.play();case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"TEST_drop",value:function(){this.base.position.y=-.5}},{key:"TEST_normal",value:function(){this.base.position.y=0}}]),t}(O),S=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.speed=3.2,e.base=new m["o"],e.FIRST_POS=-10,e.LAST_POS=30,e.CUBE_SIZE=1,e.cubes=[],e.overPosCache=-1,e.respawnDelta=-1,e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"Create",value:function(){this.overPosCache=(this.LAST_POS+1)*this.CUBE_SIZE*-1;var e=this.FIRST_POS*this.CUBE_SIZE*-1;this.respawnDelta=e-this.overPosCache;var t=this.context.loader.loadedModels[this.context.loader.GREEN_BLOCK_KEY];t.scene.traverse(function(e){e instanceof m["H"]&&(e.receiveShadow=!0)});for(var n=t.scene.children[0],r=this.FIRST_POS;r<=this.LAST_POS;r++){var a=n.clone();this.cubes.push(a),a.position.set(0,-.5,-1*r),r===this.FIRST_POS?a.rotation.y=30:r===this.LAST_POS?a.scale.set(.5,.5,.5):this.Randomize(a),this.base.add(a)}return this.base}},{key:"Animate",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=this.cubes[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;s.position.z-=e*this.speed,s.position.z<this.overPosCache&&(s.position.z+=this.respawnDelta,this.Randomize(s))}}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"Randomize",value:function(e){0===Math.floor(5*Math.random())?e.position.y=1e4:e.position.y=-.5}}]),t}(O),C=function(e){function t(e,n,r){var a;return Object(s["a"])(this,t),a=Object(c["a"])(this,Object(u["a"])(t).call(this,e)),a.FIELD_OF_VIEW=30,a.camera=new m["S"],a.wrapperElement=n,a.canvasElement=r,a.renderer=new m["rb"]({antialias:!1,canvas:a.canvasElement}),a.renderer.shadowMap.enabled=!0,a.renderer.shadowMap.type=m["R"],a.renderer.gammaOutput=!0,a.SetDevicePixelRatio(),a.UpdateCamera(),a.SetCameraLocRot(),window.addEventListener("resize",function(){a.UpdateCamera()}),a}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"Render",value:function(){this.renderer.render(this.context.scene,this.camera)}},{key:"SetCameraLocRot",value:function(){this.Camera.position.set(-2,2.5,7),this.Camera.rotation.set(m["F"].degToRad(-20),m["F"].degToRad(-17),m["F"].degToRad(0))}},{key:"SetDevicePixelRatio",value:function(){this.renderer.setPixelRatio(window.devicePixelRatio)}},{key:"UpdateCamera",value:function(){this.camera.near=1,this.camera.far=60,this.renderer.setSize(this.viewWidth,this.viewHeight),this.camera.aspect=this.viewWidth/this.viewHeight,this.UpdateCameraAspectForHeightMatch(),this.camera.updateProjectionMatrix()}},{key:"UpdateCameraAspectForWidthMatch",value:function(){this.camera.fov=this.FIELD_OF_VIEW*(this.viewHeight/this.viewWidth)}},{key:"UpdateCameraAspectForHeightMatch",value:function(){this.camera.fov=this.FIELD_OF_VIEW}},{key:"viewWidth",get:function(){return this.wrapperElement.clientWidth}},{key:"viewHeight",get:function(){return this.wrapperElement.clientHeight}},{key:"Camera",get:function(){return this.camera}}]),t}(O),x=function(){function e(){Object(s["a"])(this,e),this.scene=new m["cb"],this.clock=new m["h"],this.raycaster=new m["ab"],this.frameSkipCount=0}return Object(o["a"])(e,[{key:"InitializeAsync",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(t,n){var r,a,i,s,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=new y,e.next=3,r.LoadAsync();case 3:a={game:this,scene:this.scene,loader:r},this.camera=new C(a,t,n),t.addEventListener("touchstart",function(e){o.Tap(e)},{passive:!1}),t.addEventListener("mousedown",function(e){o.Tap(e)},{passive:!1}),this.lights=new j(a),this.lights.AddToScene(),this.background=new w(a),this.background.AddToScene(),this.thirdChan=new _(a),i=this.thirdChan.Create(),this.scene.add(i),this.blocks=new S(a),s=this.blocks.Create(),this.scene.add(s),this.animate();case 18:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"Tap",value:function(e){this.thirdChan.Jump()}},{key:"SetSpeed",value:function(e){this.blocks.speed=e}},{key:"animate",value:function(){var e=this;if(requestAnimationFrame(function(){e.animate()}),this.frameSkipCount++,this.frameSkipCount%2!==0){var t=this.clock.getDelta();this.blocks.Animate(t),this.thirdChan.Animate(t),this.raycaster.set(new m["ob"](0,0,0),new m["ob"](0,-1,0)),0!==this.raycaster.intersectObjects(this.blocks.base.children).length||this.thirdChan.isJump?this.thirdChan.TEST_normal():this.thirdChan.TEST_drop(),this.camera.Render()}}}]),e}(),k=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.speed=.02,e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){this.InitializeAsync()}},{key:"InitializeAsync",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.game=new x,this.game.InitializeAsync(document.getElementById("wrapper"),document.getElementById("canvas"));case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}]),t}(l["f"]);h["a"]([Object(l["c"])()],k.prototype,"speed",void 0),k=h["a"]([l["a"]],k);var E=k,T=E,R=(n("3cf3"),n("2877")),A=Object(R["a"])(T,p,f,!1,null,"78f1b0ff",null),L=A.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"component"},[n("p",[e._v("ver 20190812 1435 test")]),n("div",[n("label",{attrs:{for:"speed"}},[e._v("speed")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.speed,expression:"speed",modifiers:{number:!0}}],attrs:{name:"speed",id:"speed",type:"range",min:"0.000",max:"5.0",step:"0.1"},domProps:{value:e.speed},on:{__r:function(t){e.speed=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})])])},I=[],F=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.speed=.02,e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"speedChanged",value:function(e,t){return this.speed}}]),t}(l["f"]);h["a"]([Object(l["g"])("speed"),Object(l["b"])("onSpeedChanged")],F.prototype,"speedChanged",null),F=h["a"]([Object(l["a"])({})],F);var K=F,N=K,D=(n("8412"),Object(R["a"])(N,P,I,!1,null,"ed314038",null)),U=D.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"component"},[n("div",[n("label",{attrs:{for:"speed"}},[e._v("Test1")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.speed,expression:"speed",modifiers:{number:!0}}],attrs:{name:"speed",id:"speed",type:"range",min:"0.000",max:"0.1",step:"0.005"},domProps:{value:e.speed},on:{__r:function(t){e.speed=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})])])},M=[],B=(n("c5f6"),function(e){function t(){return Object(s["a"])(this,t),Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments))}return Object(d["a"])(t,e),t}(l["f"]));h["a"]([Object(l["d"])("syncedSpeed",{type:Number})],B.prototype,"speed",void 0),B=h["a"]([Object(l["a"])({})],B);var G=B,z=G,W=(n("ea82"),Object(R["a"])(z,H,M,!1,null,"d48c33c4",null)),Y=W.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"component"},[n("div",[n("label",{attrs:{for:"speed"}},[e._v("Test2")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.speed,expression:"speed",modifiers:{number:!0}}],attrs:{name:"speed",id:"speed",type:"range",min:"0.000",max:"0.1",step:"0.005"},domProps:{value:e.speed},on:{__r:function(t){e.speed=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}})])])},$=[],q=function(e){function t(){return Object(s["a"])(this,t),Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments))}return Object(d["a"])(t,e),t}(l["f"]);h["a"]([Object(l["d"])("syncedSpeed",{type:Number})],q.prototype,"speed",void 0),q=h["a"]([Object(l["a"])({})],q);var V=q,Z=V,Q=(n("8039"),Object(R["a"])(Z,J,$,!1,null,"f8d6b040",null)),X=Q.exports,ee=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.speed=.02,e.appSyncedSpeed=.05,e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){document.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1})}},{key:"onSpeedChanged",value:function(e){this.speed=e}},{key:"onSyncedSpeedChanged",value:function(){}}]),t}(l["f"]);h["a"]([Object(l["e"])()],ee.prototype,"threeWrapper",void 0),h["a"]([Object(l["g"])("appSyncedSpeed")],ee.prototype,"onSyncedSpeedChanged",null),ee=h["a"]([Object(l["a"])({components:{ThreeWrapper:L,UI:U,Test1:Y,Test2:X}})],ee);var te=ee,ne=te,re=(n("5c0b"),Object(R["a"])(ne,a,i,!1,null,null,null)),ae=re.exports,ie=n("9483");Object(ie["a"])("".concat("/20190804_three_js_and_vue_ts/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(ae)}}).$mount("#app")},ea82:function(e,t,n){"use strict";var r=n("b66c"),a=n.n(r);a.a}});
//# sourceMappingURL=app.78b9e2df.js.map